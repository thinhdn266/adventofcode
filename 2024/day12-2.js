rawData = `
CCKKKKKKKLLLLLLLLLLLLLLLLLSQQQQQQQQQQQQQQQQQQQQQQQQRRQQQQQQQQQQGGGGGGIIIIIIIPPPPPPPPPNNNNNNNNNNIIIIIIIIRRRRRRRRRRRUUUUUUUUUUTTTTTTNTTTTTTTTT
KKKKKKKLLLLLLLLLLLLLLLLLLLLQQQQQQQQQQQQQQQQQQQQQQQRRRRRRQQQQQQQGGGGGGGIIIIIPPPPPPPPPPNNNNNNNNNNIIIIIIIIRRRRRRRRRRUUUUUUUUUUUTTTTTTTVTTTHHTTT
KKKKKKCQQQLLLLLLLLLLLLLLLTQQQQQJQQQQQQQQQQQQQQQQQQRRRRRRRQRQQQGGGGGGGGGIIIIIIPPPPPPPPPPPNNNNNNNNIIIIIRRRRRRRRRRRRRRUUUUUUTTTTTTTTTTTTTTHHWWT
QIIKKKKQQQLQLLLLLLLLLLLLLLQSSQJJQQQQQQQQQQQQQQQQRRRRRRRRRRRQGGGGGGGGQQZZIIIIIPPPPPPPPPPNNNNNNNNNIIIIIIRRRRRRRRRRRRRUUUUUUTKKTCTTTTVVTTWHHWWW
QQIKKKQQQQQQQLLLLLLLLLLLLLSSSJJJJQJQQJQQQQQQQQQQRRRRRRRRRRRRGGGGGGGGZZZZIIIPPPPPPPPPNNNNNNNNNNNNIIIIIIIRRRRRRRRRRRRUUUUUCCKCGCTTTTTTTWWHHWWW
QQQKKQQQQQQQQLLDDLLLLLLLLSSSJJJJJJJJJJQQQQQQQQQQQQRRRRRRRRRRGGGGGGGGGZZZIIIPPPPPPPPPPMNNNNNNNNNNIIIIIIIIRRRRRRRRRRRUUUURRCCCCCTTTTTWWWWWWWWW
QQQQQQQQQQQQLLLDDLLLLLSSLSSSJJJJJJJJJJQQQDDDDQQQQQQRRRRRRRRRGGGGGGGGGZZIIIPPPPPPPPPPPMMNNNNNNNNIIIIIIIIISSRRRRRRRRRRRRRRRCCCCCTTTTTWWWWWWWWW
QQQQQQQQQQQLLLLDOLLLXLSSSSSSJJJJJJJJJJJQQDDDMMMMMMMMMMRRRRRRGGGGGGGGGZZZJIPIPPPPPPPPHWMWNNNNNNIIIIIISSSIVVVRRRRRUFRQRRRRCCCCCCCTTTTWWWWWWWWW
QQQQQQQQQQQLLLLDDDDDDSSSSSSJJJJJJJJJJJQQQQQDMMMMMMMMMMRRRRRGGGGGGGGGGJJBJIIIIPPPPPPWHWWWWNNNNNIIISSSSSSYVVVRRRVRFFFFURRRZCCCCCCSTTTTWWDWDWWW
QQQQQQQQQQQQQDDDDDDDDSSSSSSSJJJJJJJJJJDQQDDDMMMMMMMMMMURRRRGGGGGGGGGGJJJJJIIIPPPPPWWWWWWZNNNIIIIIISSSVVVVVVVRVVFFFFFUSRRCCCCCCCSSWWWWWDDDDWW
PPQQQQQQQQKQDDDDDDDDDDDSSSSSJJJDJIMJJPDDDWDDMMMMMMMMMMURRRRGGGGGGGGGJJJJJJIIIPPPSPWWWWWWWZZZCCCIIIXSVVVVVVVVRVVVVFFSSSSRCCCCCCCSSWDDWWWDDDDW
PPQQTQQQQKKKDDDDDDDDDDDDDSSSJJMMMMMPPPPDDDDDMMMMMMMMMMRRRDRGGGGGGJJJJJJJJJIIIIPPWWWWWWWWWCZZCCCIIIXVVVVVVVVVVVVVVVFSSSRRCCCCCCSSSSDDDWWDDDWW
PPPQPQQNQKKKKKKDDDDDDDDDURSSSMMMMMMMMPPPPDDDMMMMMMMMMMUDEDODDGGGGJJJJJJJJJJJBIPWWWWWWWWWCCZCCCCIIXXXXWVVVVVVVVVVVVVVYCCCCCCCCCSSSSDDDDDDDDDD
PPPPPQQPPPKKKKKDDDDDDUUUURRRSMMMMMMMMMPPDDDDMMMMMMMMMMDDDDDDDGGGGGJJJJJJJJJBBBDDDWWWWWWCCCCCCCXXXXWWWWVVVVVVVVJJJVVVYCCCCCCLSSSSSSVDDDDDDDDD
PPPPPPPPPJKKKKDDDDDUUUUURRRSSMMMMMMMLLPDDDDDDDDDDDDDDDDDDDDDDGGGGGGGJDJPPDDDDDDDDWWWWWWWWCCCCCCWWWWWWWWWVVVVVVJJJJWWJCCCCCLLSSSSSSSSSDDDDDDD
PPPPPPPPPPKKKKDDHDUUUUURRRRRRRMMMMMMLLLLLDDDDDDDDDDDDTDDDGGGGGGGGGGGGDPPDDDDDDDDDDDWWWWWWCCCCCWWWWWNWWWWWVVVVVJJJJJJJJCCCCLLSSSSSSSSBDDDDDDD
PPPPPPPPKKKKKKKKKKUUUUURRRRRRMMMMMLLLLLLLKKDDDDDDSSDDDDDDGGGGGGGGGGDDDDPPDDDDDDDDDDWWWGGGGGGGGGGWWWWWWWWWWVVVVVJJJJJJJJCCCCCSSSSSSSSSSDDDDDK
PPPPFFPPPKKKKKKKKKUUKURRRRRRRMJMMMMLLLLLLKKDDDDDSSSSDBDDDHHHGGGGGGDDDDDDDDDDDDDDDDDDDWGGGGGGGGGGWWWWWWWWWVVVVVVJJJJJJJJJCCCCSSSSSSSSDDDDDDDD
PPFPFFPPPKKKKKKKKKKKKULRRRMMMMMMMMMLLLLLLLDDDDSSSSSSUBBBDDHHHGGHHGHDDDDDDDDDDDDDDDDDDDGGGGGGGGGGWWWWWWWWWWWVVVVJCJJJJJJJCHHSGSSSSSSSSDDDDDDD
EEFFFPPPKKKKKKKKKKKKKULLRRRMMMMMMMMLLLLLLLBBSSSSWSSSSSBBDHHHHHHHHHHHDDDDDDDDDDDDDDDDGGGGGGGGGGGGWWWWWIIIIVVVVVJJCJJJJJJHHHSSSSSSSSSSSDDDDDQQ
EEFFEPPKKKKKKKLLLKKKKULLRRRRMMMMMMMMLULLLLBBSSSSSSSSSSBCCCCCCCCCHHHDDDDDDDDDDDDDDDDDGGGGGGGGGGGGWWWWISIIIIIVVVVVVNNJJJJJJSSSSSSSSSSSSSDDDDDQ
EEEEEKKKKKKKKKLLLKLLLLLRRRRRRMMMLMMMLRRRLBBBBSSSSSSSSSSCCCCCCCCCHHHDDDDDDDDDDDDDDDDDGGGGGGGGGGGGWWWRIIIIIIIIVVVVVNJJJJJJSSSSSSSSSSSSSSDDDDDQ
EEEEEEKKKKKGKKLLLLLLLLLLLRRRRRRRLLLRRRRRLBBBSSSSSSSSSSSCCCCCCCCCCHHDDDDFDDDDDDDDDDDDGGGGGGGGGGGGWWRGGGGGGGIAVVVVJJJJJJJJSSSSSSSSSSSSSSDDDDDD
EEEEFGGGGGKGGGLLLLLLLLLLLRRRRRRRLLLRRRRRBBBBBSSSSSSSSSCCCCCCCCCCCHDDDDDFDLDDDDDDDDDDGGGGGGGGGGGGGGGGGGGGGGIIIVJJJJJJJJIIISIISSSSRSSSSSDDDDKK
ECCCCGCGGGGGGGLLLLLLLLLMRRRRRRRRLLLLLRRCBBBCSSSSSSSSSSCCCCCCCCCCCHDDDDDFDLDDDDDDDDDDGGGGGGGGGGGGGGGGGGGGGGIVVVVVJJJJJJIIIIIRESSSRRSRRSRRKDKK
ECCCCGGGGGGGGLLLLLLLLLLLRRRRRRRRRLLLCCCCBBCCCDSSSSSSSSCCCCCCCCCCCDDDDDDDDLDDDDDDDDCCGGGGGGGGGGGGGGGGGGGGGGIVVVVXXXJJXXXIIRRRRRRSRRRRRRRRKKKK
CCCCUGGGGGGGGLULLLLLLSSSRRRRRRRRLLLLLCCCCCCCCSSSSSSSSSCCCCCCCCCIIIDDIDDDDLLLLDDDDDCCGGGGGGGGCCCCCCRGGGGGGGFVVVXXXJJJXXXIIIRRRRRRRRRRRRRRRKKK
CCCCCCGMGGGGGLLLLLLLLSSSSSSRRRRRRLLLLLCCCCCCCSBSSSSSSSCCCCCCCCCQIIIDIDDRDDLLLDDDDDCCGGGGGGGGCCCCCRRGGGGGGGFFFVVXXXXXXXXXIRRRRRRRRRRRRRRRRRKK
CCCCCCCCGGGGLLLLLLLLLLLSWSSRRLRLLLLLPLLCCCCCCSSSSSSSSSCCCCCCCCCQQIIIIIDDDDLLLLLDDLCCCCCGGGGGPCCCCRRGGGGGGGFFFFVXXXXXXXEXXRRRRRRSRRRRRRRRRRRK
CCCCCCCCGGGGGGGLLLLLLSSSWWRRLLLLLLLLPCCCCCCCCSNSSSSSSSCCCCCCCCCQIIIIIIDKKLLLLLLLDLLLCCCGGGGGPPPPRRNGGGGGGGNFFXXXXXXXXXXXDRRRRSSSSSRSSRRRKKKK
CCCCCCCCCGGGGGLLLLLLSSSSWWRRLLLLLPPPPPCCCCCCCCNNNSSSMMCCCCCCCCCIIIIIIKKKKLLLLLLLLLLLCCCGGGGGPPPPRRNNNNNNNNNFFXXXXXXXXXIIGGGGGSSSSRRSSRRSSSKK
CCHCCCTCMMGGGSSSSLSSSSSSWWTRLLLLYYPPPPPCNCCCCNNNSSSSSMCCCCCCCCCIIIIIKKKKKLLLLLLLLLVVVPPPPPPPPPPNNNNNNNNNNNNFFXFXXXXXXXXIIGGGCSSSSSRSSSSSSKKK
CCCCCWTTGGSSSSSSSSSSSSWWWWLLLYYYYYPPPPMNNNCCCNNNSSSSMMCCCCCCCCCIIIIIKKKKKKKLLLLLLLVVVVPPPPPPPPPNNNNNNNNNNNNNFFFXGXEXXXIIIIGGCSSSSSSSSSSSKKKK
CIIIWWTTTGGGGGGGGSSSSSSSWSSLLYYYYYYPPPNNNNNNNNNNNSMMMMMMMMMMMIIIIIKKKKKKKKKKKILLLLVVVVPPPPPPPPPPNNNNNNNNNNNNFFFFFEEEXXIIIIGGGSSSSSSSSSKKKKKK
IIIWWTTTGGGGGGGGGGGSSSSSSSSSYYYYYYYYYYNNNNNNNNNNNSMMMMMMMMMIIIIIIIIKKKKKKKKKKKLLLLVVVVPPPPPPPPPNNNNNNNNNNNNNFFFFFEEEXXXXIGGGGSSSSSSSSSKKKKKK
IIIIITTTTGGGGGGGGGSSSSSSYYYYYYYYYYYYNNNNNNNNNNNNNNAMMMMMMMMIIIIIIIIKKKKKKKKKKKLBBLLVVPPPPPPPPPPNNNNNNNNNNNNNFFFFFFEEXXXXIGGGGSSSSSEEKKKKKKKK
IIITTTTTTGGGGGGGGGGGSSSSSYYYYYYYYYYYVNNNNNNNNNNNNNNUMMMIIMIIIIIIIIKKKKKKKKKKKKBBBBLLLLPPPPPPPPPPNNNNNNNNNBNBFJFFEFEEXXXXXGGGGGSSEEEEKKEKKKKK
IIITTTTTTGGGGGGGGGGGSRSSSSYYYYYYYYYYYYNXNNNNNNNNNNNNCMMIIIIYYIIIIIKKKKKKKKKGGKBBBBLLLLPPPPPLPPPPNNNNNNNNBBDDDJFFEEEXXXXXJJGGJGSSREEEEEEKCKKK
IIITTTTTTGGGGGGGGGGGGRRRYYYYYYYYYYYYYYXXNWWNNNNNNNNNCMMXXIYYYIYIIIIKKKKKKKKKKKBBBBLLLLLLPPPLPPPPWWNNNINNNDDDDDEEEEEXXXXXJJJJJJSHEEEEEEEECKKC
IXIIIIITPPPGGGGGGGGGGRRRRYYYYYYYYYYYYYYYWWWNNNNNNNNNNMXXXXXYYYYYYIIKKKKKKKKKRKBBBBBXXXLPPPPLPPPPWWANIIIIIDDDDDDDEEFXXXXXXXEEEESEEEEEEEECCKCC
XXXXXIIIPPGGGGGGGGGGGRRRRRYYYYYYYYYYYYYYYWNNNNNNNNXXXXXXXXYYYYYYYYYKKKKKKKKKKBBBBBBXXXLLLLLPPPPWWWAIIIIIIDDEEDEEEFFFXXXXXEEEEEEEEEEEECCCCCCC
XXXXIIIIIPGGGGGGGGRRRRRRRYYYYYYKYYYYKYXXXJWNNNNNNXXXXXXXXXYYYYYYYYYAAKKKKKKKKBBBBBBXXXXXXXLLVPWWWWAAAIIIDDDDEEEFEFFFXXXEEEEEEEEEEEEEEECCCCCC
XXXXXIIIPPGGGGGGGGRRRRRRRYYYYYYKYYKKKKXXXJJSNNNNXXXXXXXXXYYYYYYYYYAAKKKKKKKKBBBBBBBBBXXXXXLLVPAAWWAAAAIIDDDDJEEFFFFFXXXEEEEEEEEEEEEEECCCCCCC
XXXXSSSSWWWWPGGNNNRRRRRRRRYYYYKKKKKKKXXXXJJJJNNNXXXXXXXXXYYYYYYYYYYAAUUKKKKKBBBBBBBBBXXXXXXAAJAAAWAAIITTTTIIJEFFFFFXXXXEEEEEEEEEEEEECCCCCCCC
XXXXXWWWWWWWGGNNNNRRRRRRRRYYYKKKKKKKKKXXXXXJJJNNXXXXXXXXXYYYYYYYYYAAAAKKLKKBBBBBBBBBBXXXXXXAAAAAAAAAAATTTTIJJJXFFFFXFXXFEEEEEEEEEEECCCCCCCCC
XXXXTWWWWWWWWGWNNRRRWRRRRRMYYJJKKKKKKXXXXJJJJJJNXXXXXXXXYYYYYYYYYYAAAAAALLLLBBBBBBBBXXXXXXAAAAATTTTTTTTTTTIJJJFFFFFFFFFFFEEEEEEEEEEECCCCCCCC
HTTTTJWWWWWWWGWRRRRWWRRRRRYYYJJKKKKKKKXJJJJJJJJJJXXXXXXXYYYYYYYYYAAAAAALLLLLBWBBBBBBXZZZXXAAAAATTTTTTTTTTTJJJJJFFFFFFFFFFEEEEEEEEEEECCCCCCCC
TTTTWWWWWWWWWWWWWWWWRRRRRYYJJJWWKKKKKKKKJJJJJJJJJXXXXXXXUYYYYYYAAAAAAAALLLLLLBBBBBBBBZZZAAATTTTTTTTTTTTTTTTJJFFFFFFFFFFEEEEEEEEEEEEOCCCCCCCC
VVTTWWWWWWWWWWWWWWYYYYURRWYJWWWWKKKKKMKJJJJJJJJJXXXXXXXXUYYYYYYAAAAAAAALLLLLLBBBBBBZZZZZAAATTTTTTTTTTTTTTTTJJJFFFFFFFFFEEEQEEEEEEEEOCPCCCCCC
VVTWWWWWWWWWWWWWWWYYYYYPWWWWWWWWKKKKKMMJJJJJJJJJEEXJJNVXVVSVVVVVVAAAAAALLLLLLLLLSVSZZZZAAAATTTTTTTTTTTTTTTTJJJFFFFFFFFFFEEEEEEEEOOOOCCCCCCCC
VVVWWWWWWWWWWWYYYYYYYYYYYWWWWWWWWKKKKMMMJJJJJJJEEENNNNNNVVVVVCVVVVAFAAFLLLLLLLLXSSSZZIZAAAATTTTTTTTTTTTTTTJJJJFFFFFFFFFEEEEBEEEEEZZZZCCCCCCC
VVVWWWWWWWIWWWCYYYYYYYYYYWWWWWWWWWKKKMMMMMJJJJJJENNNNNNNVVVVVVVVVVFFFFFFLLLLXXXXDSSZIIAAAAATTTTTTTTTTTTTJJJJJJJKFFFFFFEEEEZBZEDZZZZZZCCCCCCJ
VVWWWWWWWWWWWWYRRYYYYYYYYWWWWWWWWWWKPPPPPMMMMMJJJNNNNNNVVVVOVVVVVVFFFFFFFLLXXXVXSSSIIIAAAAATTTTTTTTTTTTTJJJJJJJFFFFSTTEEEEZZZZZZZZZZZCCCCCJJ
DDDWWWWWWWWWWYYYYYYYYYYYWWWWWWWWWWWPPPPPPPMMMMJJJZNNNNNVVVVVVVVVVFFFFFFFFFXXXXXXSSSIIIAAAAATTTTTTTTTTTTTJJJJJJFFFYFFTTTTTEZZZZZZZZZZZZZCCCJJ
DDBWWWWWWWWWWYYYYYYYYYYYWWWWWWWWWWWPPPPPPPPMMMMMJZZNNNNVVVVVVVVVVFNFFFFFFFXXXXXXSSIIIIAIAAATTTTTTTTTTTTTJJJJJJJJFYYTTTTTTEZZZZZZZZZZZZZYCCCC
DDDDWWWWWWWWWYYYYYYYYYYYYWWWWWWWWWPPPPPPPPPPMMIIIZZNNNNNNNVVVVVVVVNFFFFFFFXXXXXXSSIIIIIIIAATTTTTTJJJJJJJJJJJUUUYYYJTTTTTTZZZZZZZZZZZZZZYYCCR
DDDWWWWWWWWWWYYYYYYYYYYYYWWWWWWWWPPPPPPPPPPPIIUIIIZIINNNNVVVVVVFFNNFFFFFFFFXXXXXSSSTTIIXSAATTTTTTJJJJJJJJJJJUUUPJJJJTTTCCZZZZZZZZZZZZZZYYWCR
DDDDWWWWVWWWWYIGYYYYYYYYYWWWWWWWLLPPPPPPPPPPIIIWWWWWIINNNNNNVVVFSFNFNFFFFFFXXXXXXXXXXXHXSAAAHZZZZZHHZZJJJJJVUUUPJJJJTTTTTFFFFZZZZZZZZZWWYWWR
VDWWWWWVVVWGWYGGYYYYYYYYYWWWWWWWPPPPPPPPPPPIIIIWWWWWINNNNNNNNNNFFFNNNFFFFFXXXXXXXXXXXHHXSAXHHHZZHHHHZZJJJJJVUUUPJJJTTTTTTTFFFFFZZZZWWZWWWWWW
VWWVWWVVVVWGGGGGYYYYYVPYYYWWWLWLLPPPPPPPYPDIIIIWWWWWINNRNNNNNNFFFFFNNFFKFXXXXXXXXXXXXHXXXXXXHHHHHHHZZZJJJJGVVUPPJPGTTTTTCTFFFFFZWWWWWWWWWWEE
VVVVWUVVVVVGGGGGGGGZZPPPPYWWWLLLPPPPPPPPPIIIIIIWWWWWRRRRNNNNNNFFFFFFFFFFFXXXXXXXXXXXXHHXXXXXHHHHHHHHHHJJJJGGPPPPPPPBGGTTTTFFOFFZWWWWWWWWWWEE
VVVVWVVVVVVFGGGGGGPPPPPPPPPPWLLLPPPPPPPPPPIIIIIWWWWWNNNNNNNNNFJFFFFFFFFFFFXQXXXXXXXXXHHXXXXXHHHHHHHHHHGGGGGGPGGPGBBBGGGGJOOFOFOOWWWWWWWWWWWW
VVVVWVVVVVVVVVGGGXXXPPPPPPPPILLPPPPPPPLPYYIIIIIWWWWWNNNNNNNNNFFFFFFFFFFFFFQQHHXHHXXXDFHHHHHHHHHHHHHHHHGGGGGGGGGGGGBGGGGGOOOOOOOHWWWWWWWWWWWW
VVVVVVVVVVVVVVVVVXXXXXXPPPPPILLPPPPPPPPYYXIIIIIWWWWWWWWWWWNNNNFFFFFFFFFFFFFQHHHHHXHFFFFFFHHHHHHHHHHHHHHGGGGGGGGGEEGGGGGGOOOOOOOWWWWWWWWWWWWW
VVVVVVVVVVVVVVVVXXXXXXXXPPPPILIIIPIPLLPYXXIPIIIWWWWWWWWWWWNNNFFFFFFFFFFFFFYQHHHHHHHFFPFFFHHHHHHHHHHHHHHGGGGGGGGGGEEEGGGGGOOGOOWWWWWWWWWWWWWT
VVVVVVVVVVVVVVVVVVXXXXXPPPPPIIIIIIIIIIIIPXXXIIIWWWWWWWWWWWNNNFLFPPFFFFFFFFYQHHHHHHHFFFFFFHHHHHHHHHHHHHHGGGGGGGGEEEEGGGGGGGGGGGGWWWWWWWWWWWTT
VVVVVVVVVVVVVVVVVVXXXXXXXPIIIIIIIIIIIIIIPXXXXXIIWWWWWWWWWWNNNNNNPPPFFFFFFFYHHHHHHFFFFFFFFFFFHFFFHHHHHHHGGGGGGGGGEEEGGGGGGGGGGBBYWWWTWWWWWTTT
VVVVVVVVVVVVVVVVVXXXXXXXXPPIIIIIIIIIIIIKXXXXXXXIWWWWWWWWWWNNNNPPPPPFFFFFHHYYHHHHFFFFFFFFFFFFFFFZHHHHHHHHGGGGGGGGEPGDDGGGBBBGBBBYYYBTWWWWTTTT
VVVVVVVVVVVVVVVVVVXXSSSSSYSSIIIIIIIIIXKKXXXXXXXIWWWWWWWWWWNNPPPPPPFFFFFHHHYYHHHHFFFFFFFFFFFFFFPZZHZHHHHHHHGGGKKGPPGGGGGGBBBGBBBBBBBTWWWTTTTT
VVVVVVVVVVVVVVVVVXXXSSSSSSSSFFFIIIIIIXXKXXXXXXXXWWWWWWWWWWNNNPPPPPPPFFHHHHHHHHHHFFFFFFFFAFFFFPZZZZZHHHHHHHGGKKSSPPPOOGGGBBBBBBBHBBBBBDBBTTTT
VVVVVWVVVVVVVVVVUSXSSSSSSMMMMFIIIIIIIXXXXXXXXXXXXXWWWWWNNNNNNNNPPPFFFFFFHHHHHHHHFFFFFFFAAAFFFZZZZZZZHHHHHHGGKKKPPOOOOGGBBBBBBBBHHBBBBBBTTTTT
VVVVVWWVVVVVVVVVUSSSSSSSSSMMMFFIIIIIIXXXXXXXXXXXXXWWWWWEMNNNNNNPPPPPFHFHHHHHHHHFFFFFFFFFFFFFFDZZZZZLHHHHHHHSKKKPPPPOOOGGLBBBBBZBBBBBBBTTTTTT
VWWVWWWWWVVVVVUUUUSSSSSSSSSMMFFIIIIIXXIXXXXXXQQQQXWWWWWEMIMNMWMPMMPPPHHHHHHHHHHHHFFFFFFFFFCCCZZZZZZLHIIHHHHSSKPPPPPOOOGOBBBBBBBBBBBBBBTTTTTT
VWWWWWWWWWWWVUUUUUSSSSSSSMMMPFFFIPIIIIIIXXXQQQQQQQWWWWWMMIMMMMMMMMMPPPHHHHHHHHHHQSFFFFFFFCCCCZZZZZZLHHHHHHHSSSSPPPOOOOOOBBBBBBBBBBBBBTTTTTTT
WWWWWWWWWWWWWUUUUUSSSSSSSSMMPFPPIPPIIIIIXXXQQQQQQQQQQQMMMMMMMMMMMMMMPPHHHHHHJJJJSSSSFFCCCCCZZZZZZLLLSSSHHHHSSSSSSOOOOOOOOOBOOSSBBBBBBTTTTTTT
WWWWWWWWWWWWWUUUUGCSSSSSSSMPPPPPPPPPIIIIQQXQQQQQQQQQQQQMMMMMMMMMMMMMPMMDHHHHJSSSSSSSSCCCLLLZZZZZZLLLLSSSSSSSSSSSSSOOOOOOOOOOSSSSSBBBBBTTTTTT
WWWWWWWWWWWWUUUUUGCSSSSSMMMPPPPPPPPPPIIIJQQQQQQQQQQQQQQQQMMMMMMMMMMMMMDDDHHDSSSSSSSSSCCLLLLZZZZZZLLLLSSSSSSSSSSSSSSOOOOOOOOOSSSSSSSBTBBTTTTT
WWUWWWWWWWWWUUUUUGSSMSSMMGMPPPPPPGEEEEEEJJQNQQQQQQTQQQQQQMMMMMMMMMMMMMMDDHHDSSSSSSSSSSSLLLLZZZZZZLLLLLSSSXSSSSSSSOOOOOOOOOOOSSSSSSSTTTTTTTTT
WWWWWWWWWWWWUUUUUGSSMMMMMGMPPPPPPPPEEEEEEJQQQQQQTQTTTTQYAAAAAAAMMMMMMMMDDDDDSSSSSSSSSSSSLLLLLZZLZLLLLLSSSSSSSSSSSOOOOOOOOOOSSSSSSSSTTTTTITII
WSSSSSWWWWWWWUGGGGSSSMMMMGGPPPPPPPEEEEEEEEQQQRRTTQTTTLJYAAAAAAAAAAMMMMMDDDDDDDSSSSSSSSSSLLLLLLLLLLLLLLSSLSSSSSSSOOOOOOOOOOOOOOSSSTTTTTTIIIII
TTSSSSSSWWWWTGGGGGGGGGMMMGGDDDPPPPEEEEEEEEQQQTTTTTTTTLJJAAAAAAAAAAMMMDMMDDDDDDSSSSSSSSSLLLLLLLLLLLLLLLLLLLSSSSSOOOOOOOOOOOOOSSSSSSSTTTIIIIII
SSSSSSSSSWWTTGGGGGGGGGGGMGGGGGPPPPEEEEEEEEERRTTTTTTTTJJJAAAAAAAAAAMDDDDDDDDDDDSSSSSSSSSSLSSLLLLLLJJZJLLLLLLCSCCCCCOOOEEEOOOSSSSSSSSSIIIIIIII
SSSSSSSSSSWWTGGGGGGGGGGGGGGGGGEEEEEEEEEEEERRRRTTTTTTTJJJAAAAAAAAAAMPPDDDDDDDDSSSSSSSSSSSSSJJJJJLLJJJJJBBBCCCCCCCCCCOOEEEEEEESSSSSSSSSSIIIIII
YSSSSSSSSSLWTTJGGGGGGGGGGGGGGGEEESEEEEEMERRTTTTTTTTTTJJJAAAAAAAAAAPPPDDDDDDDDSSSSSSSSSSSSAAJJJJJJJJJJBBBBCCCCCCCCCCEEEEEEKESSSPVVSSSIIIIIIII
YSSSSSSSSSJJTTJJJGGGGGGGGGGGGSSSSSEKMMMMMRRRTTTTTTTJJJJJAAAAAAAAAAPPPDDDDDDDSSSSSSSSSSSSSSAAJJJJJJJJJBBBBBCCCCCCCCCEEEEEEERRSSVVVVVVDDIIIIII
YSSSSYYSSWJJJJJJJJJGGGGGGGGXGSSSSUUKKMMMRRRRTTTTTTTJJAAAAAAAAAAAAARRPPDDDDPPXSSSSSSSSSSSSSAAAJJJJJJJJBBBBBBBCCCCDDEEEEEEEEERSVVVVVVVVVIIIIII
YYSSSYYYYJJJJJJJJJGGGGGGGGGGSSSSUUUKMMMMMMRRRTTTTTTJJAAAAAAAAAAAAAPPPPPPDDPPXXSSSSSAAAAAAAAAJJJJJJJJJJJJJJBBCCCCDZZZEEEEEEEENVVVVVVVVVIIIIII
YYSYYYYJJJJJJJJJJGGGGGGGGGGSSSUSUUMMMMMMMMRTTTTTTJTJJAAAAAAAAAAAAAPPPPPPPPPPPXSXSSSAAAAAAAAAJJJJJJJJJJJJJJBBBBBBZZZZEEEEEEEEVVVVVVVVVVIIFIII
YYYYYYYJJJJJJJJJJJJJGGGGGGGSSSUSUUMMMMMMMMMMBBTTJJJJJAAAAAAAYYRRPPPPPPPPPPPPPXXXSXXKAAAAAAAAJJKJJJJJJJJJJJBBBZZZZZZZEEEEEERRRVVVVVVVVVVVFFFF
YYYYYJJJJJJJJJJJFFJJJGGGGGGUUUUUUMMMMMMMMMMMMBTTTJJJJAAAAAAAYYRPPPPPPPPPPPPPPXXXXXXKKKKKAAAJJJJJJJJJJJJJBBBBBZZZZZZZEEEEEEVVVVVVVVVVVVVVVFFZ
YYYYYJJJJJJJJJJJJJJJIIIGGGUUUUUUUMMMMMMMMMMMBBTTJJJJJAAAAAAAYYRPPPPPPPPPPPOOXXXXXXXKKKKKKAAZIIJJJJJJJJJJBBBBBBBZZZEEEEEEEEEVVVVVVVVVVVVVVVZZ
YYYYJJJJJJJJJJJJJJJJIITTGGUUUUUUUUMMMMMMMMMMMMJJJJJJJAAAAAAARRRPPPPPPPPPPPOOOXXXXXXKKKKKKKAZIIZJJJJJJJJJBBBBBBBBZZZEEEEEEVEVVVVVVVVVVVVVVFOZ
YYYYYJJJJJJJJJJJJJJJIIIIIIUUUUUUUUCCCMMMMMMMMMMMMJJJJJJYYYYYYRYYPPPPPPPOOOOOOXXXKKKKKKKKKKZZZZZJJJJJJJJJBBBBBBBBBSZUEEEEEVVVVVVVVVVVQOOVOOOZ
YYYYYJJJJJJJJJJJJJZZIIIIIIUUUUUUUUUUUMMMMMMMMMMMMJJJJJJJYYYYYYYYPPPPPPPOOOOOOOOOKKKKKKKKKZZZZZZJZZJJJJJJBBBBBBBBBBBUUUEEEEVVVVVVVVVVVOOOOOOZ
YYYYYJJJJJJJJJJJJMBIIIIIIIIUUUUUUUUUUMMMMMMMMMMJJJJJJJJJJYYYYYYYYYYPPPPOOOOOOOOOKKKKKKKKKZZZZZZZZZJJJJHJBBBBBBBBBBBUUUEUUUUVVVVVVVVVVOOOXXOZ
YYYYYJJJJJXXJJJJBBBDIIIIIIEUUUUUUUUUUMMMMMZKFFMMJJJJJJJJJYDYYJYYYYYYYPPOOOOOOOOOOOKKKKKKKZZZZZZZZZZJJJHHHHBBBBBBBBBUUUUUUVVVUVVVZVBBOOOOXXOO
YYYYYJYYJJHXHJJJBBBDIIIIEEEEEUUUUUUUUMFMMMKKKKCCCJJJJJJJJJDDYYYYYYYYPPPOOOOOOOOOOOKKKKKKKZZZZSZZZZZJJJHHHHNBBBBBBUUUUUUUUUUUUVJVVVOOOOOOOXOO
YYYYYYYYHHHHHHHBBBBIIIIIEEEEEUUUUUUNNMFMFFKLKKCCJJJJJJJJJJDDYYYYYYYYPPPOOOOOOOOOOKKKKKKKKKZZZZZZZZZJJIKHHHNNBBBBBUUUUUUUUUUUCSCMVEEOOOOOOOOO
YYYYYYYYYRXHXHBBBBBIIIIEEEEUUUUUUUUUUFFFFFFKKKKCJJJJJJJJJMYYYYYYYYYYYOOOYYOOOOOOOOKKKKKKKKZZZZZZZZZZKKKHHNNNNNBBBUUUUUURRUCCCCCCEEEOOOOOOOOO
YYYYYYYYYRHHHBBBBBBBBBBBBBBKUUUUUUUUUUUFFFFKKKKKKJUCCCCCCYYYYYYYYYYYYYYOOOOOOOOOOOOKKKKKKKKKZZZZZZZZKHHHNNNNNNBBBUUUURRRQCCCCCCCEEOOOOOOOOOO
YYYYYYYYYRBBBBBBBBBBBBBBBBBKUUUUUUUUUUUUKFKKKKKKKUUCECCCCDYYYYYYYYYYYYYAOOOOOOOSOOKKKQQQKKKKKZZZZZKKKHHHHHNNNNNNNNRRRRRRQCCCCCCCEELOOOOOOOOO
YYYYYYYYRRRBBBBBBBBBBBBBBBSUUUUUUUUUUUUAKKKKKKKCKCCCCCCCCDDYYYYYYYYYYYYAAOOOOOOOHHKKKQQQKKKKZZZRZZKKKHHKKHNNNUNNNRRRRRRRCCCCCCCTLLLOOOOOOOOO
YYYYKUUUUUBBBBBBBBBBBBBBBBSSUUTUUUUUUUAAKAKKKKKCCCCCCCCCCCCWYYYYYYYYYYYYYHOOBOOHHHQQQQQQQQQQBBBBZZZKKKKKKHKKKKNNNRRRRRRRCCCCCCCCLLVOOOOOOOOO
YYYYKKUUUUUBBUUUBBBBBBBBBBSSSUUSUUUUUUAAAAKKKKKKKCCCCCCCCCCCCCCYYYYYYHHHHHHOOOHHHHQAQQQQQQQQBBBZZKKKKKKKKKKKKYYNNRRRRRRCCCCCCCCCLLLLOOOOOOOO
YYKKKKUUUUUUUUUBBBBBBBBBBBSSSUSSUUUSAAAAAKKKKKKKKCCCCCCCCCCCCCCYYYYYYYHHHHHOHHHHHQQQQQQQQQQQBBBBBKKKKKKKLKKKKYYYRRRRRRCCCCCCCCCCLCJJZZZODOOS
YYKKKKKUUUUUUUUBBBBBBBBBBBBBSSSSSUUSAQAAAKKKKKKKKKCCCCCCCCCCZZZYYYYYYHHHHHHHHHHHHHQQQQQQQQQQBBBIBKKKKKKKKKKKKKRRRRRRRRCCCCCCCCCCCCJZZZZOOOOS
YKKKKKKKKKUUUUGBBBBBBBBPPBBBSSSSSUSSSQQKKKKKKKKKKKCCCCCCCCCCCCHHHYHYHHHHHHBBBBHHHHQQQQQQQQBBBBBBBKBKKKKKKKKKKKKRRRRRRRCCCCCCCCCCTCCZZZZZZZOS
KKKKKKKKKUUUUUUBBBBPPPPPPPSSSSSSSSSSSQKKKKKKKKKKKKCTCCCCCCCCYCHHHHHHHHBHHBBBBHHHHQQQQQQQQQQBBBBBBKBKKKKKKKKKKKRRRRRRRRRRCCCCCCCCTTZZZZZZZZSS
KKKKKKKKKKUUUUUBBBBPPPPPPPSSSSSSSSSSSQKKKKKKKKKKKKCCCCCCCCCYYYYYHHHHHHBBBBBBBGGGHQQQAQQQQQQQQBBBBBBKKKKKKEEEKKRRRRRRRRRRZCCCCCCCTTZZZZZZZZZZ
KKKKKKKUUUUUUUUUBBBPPPPPPPSSSSSSSSSSSQKOKKKKKKKKKKCCCCCCCCYYYYYYHHHHHHBBBBBBBGGGHHGGGQQQQQEEEEBBBBBBKKEKKEEEEERRRRRRRRRRCCTTCCCCTTTZZZZZZZZZ
EKKKKKKKKKUJUUUUBBBBPPPPPPSSSSSSSSSSSSSSKKKKKKKKKKCCCCCCCCYYYYYYHHHHHHBBBBBBUGGGHGGGGGQQQQEEEEEEEBBBBKEKEEEEEERRRRRLRRRRRRTTKKKKTZZZZZZZZZZU
KKKKKKKKKKUJUUAABJBBPPPHPPSSSSSSSSSSSSSKKKCKKKKKKKCCCRRRCCCYYYYYYHHHHBBBBBBBUGGGGGGGQQQQQQQEEEEEEBBBBEEEEEEEEEEERELLLLRRRRTTKKKKTTTTZZZZZZUU
GKKKKKKKKUUUUUUGGJJPPPPHHPSSSSSSSSSSSSSSSSCCCKKKKKCKRRRRRRYYYYYYHHHHHHBBBBBBBGGGGGGQQQQQQQEEEEEHHBBBEECCCEEEEEEEEELLLLRRLLTKKKKKTTTTZZZZZZUU
GKKKKKKKKUUGUGGGGJHHPPPHHPSHHSSSSSSSSSSSCCCCCKKKKKKKRRYYYYYYYYYYYHHHHBBBBBBBJGGGGGGGQQQQQEEEEEEHHBBBCCCCCCEEEEEEEELLLLRRQLTTKKKKTTTTZUZZZUUU
GGKKKKKKKAGGGGGGJJJJJJJJJJHHHHSSSSSSSSSSCCCCKKKKVKKRRRRRYYYYYYYYHHHHHHBBBBBBJGGGGGGGQQQHQQQQEEHHHCCCXCCCEEEEEEEEEELLLLLLLLTTTKKKTTTTZZZZZZZU
GGGKKKKKKGGXGGGGJJJJJJJJJJHHHVVVSSSSSSSSCCCCCCCVVVRRRRRRYOYVYCCHHHHHHHBBBBJJJGGGGGGGQHQHHHEEEHHHHCCCCCCCCEEEEEEELLLLLLLLLLTTTTTTTTTTTTTTZZZU
GGKKKKKKGGGGGGGGJJJJJJJJJJHHHVSSSSCSSSCCCCCCCCCVVVVRRVVVVVVVVHHHHHHHHHHBIBGGGGGGGGGGHHHHHHHEHHHHHCCCCCCCCCCCEEELLLLLLLLLLLLTTTTTTTTTTTTTTTZD
GGKKKKKKGGGGGGGGJJJJJJJJJJHHHVWQSCCCCCCCCCCCDCVVVVVVVVVVVVVVMHHHHHHHHHQBBBGQGGTGGGGGDHHHHHHHHHHHHCCCCCCCCCCEEEELLLLLLLLLLLLTTTTTTTTTTTTTTTTD
GGGKGGGGGGGGGGGGJJJJJJJJJJHSHWWWWCCCCCCCCCFFFFFVVVVVVVVVVVVVMHHMHMMMMMQQQQQQQQGGGGHHHHHHHHHHHHHHPPCCCCCCCCMQQEELLLLLLLLLLLTTTTTTTTTTTTTTTTTD
GGGGGGGGGGGGGGGGJJJJJJJJJJSSWWSWWCCCCCCCCDFFFFFVJVVVVVVVVVVVMHHMMMMMMQQQQQQQQQGGQQHHHHHHHHHHHHHHCCCCCCCCCCCQQQLLLLLLLLLLLLLTLKKKKTTTDDTDDDDD
UUUUGUGGGGGGGGGGJJJJJJJJJJSSSSSSCCCCGCGFFFFFFFFDVVVVVVVVVVVMMMMMMMMQQQQQQQQQQQQQQQHHHHHHHHHHHHCCCCCCCCCCCCCQQLLLLLLLLLLLLLLTLKKKKTTTDDDDDDDD
UUUUUUUGGGGGGGGGGGLLBBHMSSSSSSSSSGGGGGGFFFFFFFFDDDVVVVVVVVVMMMMMQQQQQQQQQQQQQQQQHHHHHHHHHHHHHHHCCCCCCCCCCCCQQLLLLLLLLLLLLLLLLKKKKTTTDDDDDDDD
UUUUUUUUGGGGGGGGGGLBBHHSSSSSSSSSGGGGGGGFFFFFFFFDDDVVVVVVVVMMMMMMMMQQQQQQQQQQQQQQHHHHHHHHHHHHHHHCCCCCCCCCCQQQLLLLLPLLLLLLLLLLLLKKKKTTTDDDDDDD
UUUUUUUUGGGGGSSSGLLLBSSSSSSSSSSSSGGGGGGFFFFFFFDDDDDVVVVVVVMMMMMMQQQQQQQQQQQQQQQPTTHHHHHHHHHHHHHCCCCCCCCCQQQQQQLBBPLLLAALLLLKKKKKKKKTTDDDDDDD
UUUUUUUUUUUGSSSSSBBBBBSSSSSSSSSSSRGGGGGFFFFFDDDDDDDVVVVVVVVMMMMMMMMQQQQQQQQQQQQPTTTHHHHHHHHHHHHCCCCCCCCQQQQQQQBBBBWLAAAALLLKKKKKKKTTDDDDDDDD
UUUUUUUUDUSGSSSSSSBBBBBSSSSSSSSSRRGGGGGFFFFFCDDDDDDVVVVVVCCMMMMMMMMMMQQQPPQPQPQPPTTHHHHHHHHHHHCCCCCCPCCQQQQQBBBBBBBAATTAATLKKKKKKKDDDDDDDDDD
UUUUUUUUUUSSSSSSSSBBBBSSSSSSSSSSRRGGGGGGFFFFCCDDDDDTTTVVVCCCCMMMMMMMMMQPPPPPPPPPPTHHHHHKKHHHHHHCCCCCQCQQQQQQBBBBBBBBATTTTTTTTKKKKNNNNDDDDDDD
UUUUUUUUUUSSSSSSSSBSSSSSSSSSSSSSSGGGGGGGGGCCCCCDDDDDDTVVVCCCCCMMMMMMMAATPPPPPPPPPTHHHHHKKHHHHHHCCCCQQQQQQQQBBBBBBBBBTTTTTTTTTKKKKKKNNNDDDDDD
UUUUUUUUSUSSSSSSSSSSSSSSSSSSSSSWGGGGGGGGGGCCCCCDDDDDDDDVVCCCCCMMMMMMMAAATPPPPPPPTTHKKKKKKHHHHHCCCQQQQQQQQQBBBBBBBBBTTOTTTTTTLKKKKKKNNNDDDDDD
UUUUUUSSSSSSSSSSSSSSSSSSSSSSSSSWPGGGGGGGGGCCCCCGDDIIIDHVVVCCCCCMMMMMAAAAPPPPPPPEEEKKKEKEEHHHHHHCQQQQQQQQQQQBBBBBBBZTTTTTTTTTKKKKEKKGGGGGGGDG
UUUUUUUUSSSSSSSSSSSSSSSUUSSSSWSWWGGGGCGGGGCCCCCCCIIIICCCCCCCCCCCJJMAAAAPPPPPPEEEEEEEEEEEEEEHHHHHHQQQQQQQQQQBBBBBBBZZTTTTTTTTTKKKKKKGGGGGGGGG
UUUUBUSUSSAAAASSSSSSSSSUUUSSSWWWWGGGGCGGCCCCCCCCCIIIIICCCCCCCCCCCCAAAAAAPPAAEEEEEEEEEEEEEEEHHHHHQQQCQQQQQQQBBBBBBBZZTTTTTTTTTTBKGGKGGHHGGGGG
DDUUUSSSSAAAAAAASSSSSSSSUUUWWEWVWGFGCCCCCCCCCCCCIIXXXICCCCCCCCCCAAAAAAAAPPPAPPPEEEEEEEEEEUUUUUHHMQQQQQQQQQQQBHBBBBBTTTTTTTTTTTTGGGGGHHHGHGGG
DUUUUSSSSSBBAAAASSSSSSSUUUWWWWWVWFFFFFCCCCCCCCCCXXXXXCCNCCCCCCCCAAAAAAAAPAAAPPEEEEEEEEEEEUEEEUUZZQQQQQQQQQNZHHHBBBBTTTTTTTTTTTTGGGGGHHHHHGGG
DDDDUDDSSSSAAAAAASSSSUUUUUWWWWWWWWFFFCCCCCCCCCCCXXXAXACCCCCCCCCCCAAAAAAAAAAAAPEEEEEEEEEEEEEEEUZZZZQQQQQQQQZZZHHHBBBSTTTTTTTTTTGGGGGHHHHHGGGG
DDDDDDDSSSZAAAAAASSSUUUUUUWWWWWWWWFFFFFFCCCCCCCCCXXAAACECCCCCCCCCCAAAAAAAAAAAAAEEEEEEEEEEEWZUUUZZZZQZQZQQQZHHHHHHHBTTTTTTTTTTTGGGGGHHGHGGGGG
DDDBDDDDSDAAAAAAAUUUUUUUUUWWWWWWWWFFFFCCCCCCCCCCCCAACCCCCCCCJCCCAAAAAAAAAAAAAAEEEEEEEEEEEEEZZUUZZZZZZZZQZZZHZHHHHHHHHTTTTTTTTGGGGGGHHGGGGGGG
DDDBBDDDSDDDDAAVVVUUUUUUUUUWWWFWWFFFFFCCCCCCCCCCCCCCCCCCCCCJATAAAAAAAAAAAAAAAAAAEEEEEEEEEEEZZZZZZZZZZZZZZZZZZHHHHHHHHTTTTTTTGGGGGGGHHGGGGGGG
DDDBBBDDDDDDDDAAAAAUUUUUUUUWFFFFFFFFFCCCCCCCCCCCCCCCCCJCCCCJAAAAAAAAAAAAAAAAAAAAEEEYYEEYYEEESSZZZZZZZZZZZZZZHHHHHHHHTTTTTTTGGGGGGGGGGGGGGGGG
DDDBBDDDDDDDDDDDAQQQUUUUUUUFFFFFFFFFFFFCCCCCCCCCCCCKCCJJJJJJAAAAAAAAAAAAAAAAAAAEEEYYYYYYYYESSSSSZZZZZZZZZZZZHHHHHHHHHTTTTTTGGGGGGGGGGGGGGGGG
`;

data = rawData
  .trim()
  .split("\n")
  .map((s) => s.split(""));

let key = (x, y) => `${x}_${y}`;

regions = {};

function isClose(pos1, pos2) {
  let [x1, y1] = pos1.split("_").map(Number);
  let [x2, y2] = pos2.split("_").map(Number);
  return Math.abs(x1 - x2) + Math.abs(y1 - y2) === 1;
}

function refillRegion(groups, i, j) {
  let foundGroups = [];
  for (g = 0; g < groups.length; g++) {
    let group = groups[g];
    found = group.find((r) => isClose(r, key(i, j)));
    if (found) {
      foundGroups.push(g);
    }
  }
  if (foundGroups.length === 1) {
    groups[foundGroups[0]].push(key(i, j));
    return groups;
  }
  if (foundGroups.length > 1) {
    let newGroups = [];
    let combinedGroup = foundGroups.reduce(
      (acc, val) => acc.concat(groups[val]),
      []
    );
    combinedGroup.push(key(i, j));
    newGroups.push(combinedGroup);
    for (g = 0; g < groups.length; g++) {
      if (!foundGroups.includes(g)) {
        newGroups.push(groups[g]);
      }
    }
    return newGroups;
  }
  groups.push([key(i, j)]);
  return groups;
}

for (let i = 0; i < data.length; i++) {
  for (let j = 0; j < data[i].length; j++) {
    if (regions[data[i][j]]) {
      regions[data[i][j]] = refillRegion(regions[data[i][j]], i, j);
    } else {
      regions[data[i][j]] = [[key(i, j)]];
    }
  }
}

dir = {
  up: [-1, 0],
  down: [1, 0],
  left: [0, -1],
  right: [0, 1],
};

side = {
  up: "T",
  down: "B",
  left: "L",
  right: "R",
};

conflictSide = {
  up: "B",
  down: "T",
  left: "R",
  right: "L",
};

function checkConflict(s, x, y, sidesObj) {
  let [dx, dy] = dir[s];
  let sides = sidesObj[side[s]];
  let conflictSides = sidesObj[conflictSide[s]];

  found = conflictSides.indexOf(key(x + dx, y + dy));
  if (found !== -1) {
    conflictSides.splice(found, 1);
  } else {
    sides.push(key(x, y));
  }
}

function countPeri(sidesArr, s) {
  let newSides = [];
  for (pos = 0; pos < sidesArr.length; pos++) {
    let foundGroups = [];
    let [x, y] = sidesArr[pos].split("_").map(Number);
    for (ns = 0; ns < newSides.length; ns++) {
      let found = newSides[ns].find((r) => isClose(r, key(x, y)));

      if (found) {
        foundGroups.push(ns);
      }
    }
    if (foundGroups.length === 1) {
      newSides[foundGroups[0]].push(key(x, y));
      continue;
    }
    if (foundGroups.length > 1) {
      newSides = [];
      let combinedGroup = foundGroups.reduce(
        (acc, val) => acc.concat(newSides[val]),
        []
      );
      combinedGroup.push(key(x, y));
      newSides.push(combinedGroup);
      for (ns = 0; ns < newSides.length; ns++) {
        if (!foundGroups.includes(ns)) {
          newSides.push(newSides[ns]);
        }
      }
      continue;
    }
    newSides.push([key(x, y)]);
  }

  return newSides;
}

function calculatePerimeter(region) {
  let peri = 0;
  let sides = {
    T: [],
    B: [],
    L: [],
    R: [],
  };
  for (let pos of region) {
    let [x, y] = pos.split("_").map(Number);
    for (let s in dir) {
      checkConflict(s, x, y, sides);
    }
  }

  for (let s in sides) {
    peri += countPeri(sides[s], s).length;
  }

  return peri;
}

total = 0;
for (let key in regions) {
  console.log(key, regions[key]);

  for (let region of regions[key]) {
    regionP = calculatePerimeter(region);
    total += regionP * region.length;
  }
}

console.log(total);
